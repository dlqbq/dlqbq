name: deploy blog

on:
  push:
    branches: [ main ]
  # pull_request:
  #   branches: [ main ]
  # schedule:
  #   - cron: 0 12 * * *
  workflow_dispatch:
  watch:
    types: started

jobs:
  build:
    runs-on: ubuntu-latest
    if: github.event.repository.owner.id == github.event.sender.id

    steps:
      - uses: actions/checkout@v4
        # with:
        #   token: ${{ secrets.GITHUB_TOKEN }}
        #   # If your repository depends on submodule, please see: https://github.com/actions/checkout
        #   submodules: recursive
      - name: Use Node.js 20
        uses: actions/setup-node@v4
        with:
          # Examples: 20, 18.19, >=16.20.2, lts/Iron, lts/Hydrogen, *, latest, current, node
          # Ref: https://github.com/actions/setup-node#supported-version-syntax
          node-version: '20'
      - name: Cache NPM dependencies
        uses: actions/cache@v4
        with:
          path: node_modules
          key: ${{ runner.OS }}-npm-cache
          restore-keys: |
            ${{ runner.OS }}-npm-cache
      - name: Install Dependencies
        run: npm install
      - name: Install theme
        run: git clone https://github.com/xiangming/landscape-plus.git themes/landscape-plus
      - name: Build
     #   run: npm run build
        run: |
          git config --global user.email "${{ secrets.EMAIL }}"
          git config --global user.name "${{ secrets.USER_NAME }}"
      - name: Deploy
        run: npm run clean && npm run deploy
      - name: Upload Pages artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: ./public
 # deploy:
 #   needs: build
 #   permissions:
 #     pages: write
 #     id-token: write
 #   environment:
 #     name: github-pages
 #     url: ${{ steps.deployment.outputs.page_url }}
 #   runs-on: ubuntu-latest
 #   steps:
 #     - name: Deploy to GitHub Pages
  #      id: deployment
 #       uses: actions/deploy-pages@v4
